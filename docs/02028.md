# 红移物化视图

> 原文:[https://www.educba.com/redshift-materialized-views/](https://www.educba.com/redshift-materialized-views/)

![Redshift materialized views](../Images/c2c6eb47ece77b4372a289cc0ab6fecc.png)

<noscript><img class="alignnone size-full wp-image-448135" src="../Images/c2c6eb47ece77b4372a289cc0ab6fecc.png" alt="Redshift materialized views" width="900" height="500" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views.jpg 900w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-300x167.jpg 300w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-768x427.jpg 768w" sizes="(max-width: 900px) 100vw, 900px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views.jpg"/></noscript>

## 红移物化视图简介

以下文章提供了红移实体化视图的概述。在大型表上执行大型密集查询(如聚合、连接)会降低性能，为了克服这一点，Redshift 引入了物化视图概念，应用程序将查询物化视图并获得预计算的结果集(这可能是重复的)。这样，性能也会提高。

红移物化视图在不访问基表的情况下获得预计算的数据结果集，从而提高了性能。如果我们考虑一个场景，我们必须从基表中获取数据，对数据进行一些分析，并以任何仪表板或报告格式为用户填充数据。这里可以频繁地进行分析，而不是一次又一次地分析和查询基表。我们可以创建物化视图，它可以保存我们计划在仪表板中描绘的分析数据。当我们创建物化视图时，红移将运行用户指定的查询，获取数据，并存储结果。

<small>Hadoop、数据科学、统计学&其他</small>

让我们在下面的讨论中看到更多。

**语法:**

`CREATE MATERIALIZED VIEW NAME_MV
[ BACKUP { YES | NO } ] [ Mention_table_attributes ] [ Auto refresh { YES | NO } ] AS query`

**Backup:** Backup 是指定物化视图是否包含在集群快照中的子句。默认值为是。

**表属性:**指定数据在物化视图中的分布方式。对于分发样式 DISTSTYLE { EVEN | ALL | KEY } ]。用于分发密钥 DISTKEY(标识符)。

**自动刷新:**指定物化视图是否要用基表的最新数据自动刷新。默认值是“否”

### 物化视图如何在红移中工作？

现在让我展示物化视图的图形表示，稍后我们将继续创建、修改和自动刷新。

下面是“剧场”和“价格”表的实体化视图。

**物化视图**

| **电影 _ 名称** | **剧场 _ 课堂** | **剧院 _ID** | **总计(客户编号*价格)** | **平均值(客户数量/价格)** |
| 钢铁侠 | 交流电（alternating current） | One hundred and twenty-three | Two hundred | One hundred |
| 蜘蛛侠 | 常态 | Three hundred and forty-five | Two hundred | One hundred |

**剧院桌(基础桌)**

| **电影 _ 名称** | **剧场 _ 课堂** | **剧院 _ID** |
| 钢铁侠 | 交流电（alternating current） | 123 |
| 钢铁侠 | 交流电（alternating current） | 123 |
| 蜘蛛侠 | 常态 | N_345 |
| 蜘蛛侠 | 常态 | N_345 |

**价格表(基础表)**

| **剧院 _ID** | **客户数量** | **价格** |
| 123 | One hundred | One hundred |
| N_345 | Two hundred | One hundred |

**例子:**

创建一个如下的表格，并在其中插入数据。

`Create table Theatre
(
Movie_name varchar(20),
Theatre_class varchar(20),
Theatre_id varchar(15)
);`

相同的截图:

![Redshift materialized views output 1](../Images/ab52fbb2dd1253fb010c93973a40629f.png)

<noscript><img class="alignnone size-full wp-image-447708" src="../Images/ab52fbb2dd1253fb010c93973a40629f.png" alt="Redshift materialized views output 1" width="601" height="241" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-1.png 601w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-1-300x120.png 300w" sizes="(max-width: 601px) 100vw, 601px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-1.png"/></noscript>

插入如下数据:

`Insert into theatre values ( 'Iron Man', 'AC', 'A_123' );
Insert into theatre values ( 'Iron Man', 'Normal', 'N_123' );
Insert into theatre values ( 'Spider Man', 'AC', 'A_345' );
Insert into theatre values ( 'Spider Man', 'Normal', 'N_345' );
Insert into theatre values ( 'Frozen', 'AC', 'A_456' );
Insert into theatre values ( 'Frozen', 'Normal', 'N_456' );
Insert into theatre values ( 'Bat Man', 'AC', 'A_777' );
Insert into theatre values ( 'Bat Man', 'Normal', 'N_777' );
Insert into theatre values ( 'X-Man', 'AC', 'A_888' );
Insert into theatre values ( 'X-Man', 'Normal', 'N_888' );`

相同的截图:

`select * from theatre;`

![Redshift materialized views output 2](../Images/4e847c9d6a6d4c1cbfba4efaeb7fb7aa.png)

<noscript><img class="alignnone size-full wp-image-447709" src="../Images/4e847c9d6a6d4c1cbfba4efaeb7fb7aa.png" alt="Redshift materialized views output 2" width="601" height="359" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-2.png 601w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-2-300x179.png 300w" sizes="(max-width: 601px) 100vw, 601px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-2.png"/></noscript>

![Redshift materialized views output 3](../Images/6bbb4867e6e6f2fc852ef604b4a955f3.png)

<noscript><img class="alignnone size-full wp-image-447710" src="../Images/6bbb4867e6e6f2fc852ef604b4a955f3.png" alt="Redshift materialized views output 3" width="601" height="381" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-3.png 601w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-3-300x190.png 300w" sizes="(max-width: 601px) 100vw, 601px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-3.png"/></noscript>

表格创建和数据插入。

`Create table PRICE
(
Theatre_id varchar(15),
No_of_cust INT,
Price INT
);`

相同的截图:

![Redshift materialized views output 4](../Images/79f617db24a73ff33d14b9af313dd2f2.png)

<noscript><img class="alignnone size-full wp-image-447711" src="../Images/79f617db24a73ff33d14b9af313dd2f2.png" alt="Redshift materialized views output 4" width="601" height="321" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-4.png 601w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-4-300x160.png 300w" sizes="(max-width: 601px) 100vw, 601px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-4.png"/></noscript>

`Insert into PRICE values ( 'A_123' , 50, 150 );
Insert into PRICE values ( 'N_123' , 60, 100 );
Insert into PRICE values ( 'A_345' , 50, 250 );
Insert into PRICE values ( 'N_345' , 50, 150 );
Insert into PRICE values ( 'A_456' , 40, 200 );
Insert into PRICE values ( 'N_456' , 50, 150 );
Insert into PRICE values ( 'A_777' , 50, 300 );
Insert into PRICE values ( 'N_777' , 50, 200 );
Insert into PRICE values ( 'A_888' , 50, 250 );
Insert into PRICE values ( 'N_888' , 50, 150 );`

相同的截图:–

`Select * from price;`

![output 5](../Images/656a3d8d85b776eeda399c840ab23ed3.png)

<noscript><img class="alignnone wp-image-447712 size-full" src="../Images/656a3d8d85b776eeda399c840ab23ed3.png" alt="output 5" width="602" height="384" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-5.png 602w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-5-300x191.png 300w" sizes="(max-width: 602px) 100vw, 602px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-5.png"/></noscript>

![output 6](../Images/b435bd139bbb28d6a3f17ea7883e7990.png)

<noscript><img class="alignnone wp-image-447713 size-full" src="../Images/b435bd139bbb28d6a3f17ea7883e7990.png" alt="output 6" width="601" height="427" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-6.png 601w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-6-300x213.png 300w" sizes="(max-width: 601px) 100vw, 601px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-6.png"/></noscript>

**创建物化视图:**

将物化视图 MV_theatre_analysis 创建为

`Select t.movie_name,
T.theatre_class ,
T.Theatre_id,
P.No_of_cust * p.price as Total_Price,
AVG (p.PRICE) as Average_Price
From theatre t , price p
Where t.theatre_id = p.theatre_id
group by 1,2,3,4 ;`

相同的截图:–

![output 7](../Images/a72c912893bda2354b54b280f57fc171.png)

<noscript><img class="alignnone wp-image-447714 size-full" src="../Images/a72c912893bda2354b54b280f57fc171.png" alt="output 7" width="544" height="459" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-7.png 544w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-7-300x253.png 300w" sizes="(max-width: 544px) 100vw, 544px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-7.png"/></noscript>

使用以下语句从实体化视图中选择数据:–

`Select * from MV_theatre_analysis;`

![output 8](../Images/a49938139f6f52f4f7ad4b3cd0da7001.png)

<noscript><img class="alignnone wp-image-447715 size-full" src="../Images/a49938139f6f52f4f7ad4b3cd0da7001.png" alt="output 8" width="602" height="383" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-8.png 602w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-8-300x191.png 300w" sizes="(max-width: 602px) 100vw, 602px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-8.png"/></noscript>

![output 9](../Images/97552ce37cb514085e304cbec669db9b.png)

<noscript><img class="alignnone wp-image-447716 size-full" src="../Images/97552ce37cb514085e304cbec669db9b.png" alt="output 9" width="601" height="373" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-9.png 601w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-9-300x186.png 300w" sizes="(max-width: 601px) 100vw, 601px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-9.png"/></noscript>

**输出:**

| **电影 _ 名称** | **剧场 _ 课堂** | **剧院 _id** | **总价** | **平均价格** |
| 钢铁侠 | 常态 | N_123 | Six thousand | One hundred |
| 冰冻的 | 交流电（alternating current） | 456 | Eight thousand | Two hundred |
| 勤务兵 | 常态 | N_777 | Ten thousand | Two hundred |
| 蜘蛛侠 | 常态 | N_345 | Seven thousand five hundred | One hundred and fifty |
| x 战警 | 交流电（alternating current） | A_888 | Twelve thousand five hundred | Two hundred and fifty |
| 蜘蛛侠 | 交流电（alternating current） | A_345 | Twelve thousand five hundred | Two hundred and fifty |
| 冰冻的 | 常态 | N_456 | Seven thousand five hundred | One hundred and fifty |
| 钢铁侠 | 交流电（alternating current） | 123 | Seven thousand five hundred | One hundred and fifty |
| 勤务兵 | 交流电（alternating current） | 777 | Fifteen thousand | Three hundred |
| x 战警 | 常态 | N_888 | Seven thousand five hundred | One hundred and fifty |

**更改物化视图:**

`Alter materialized view MV_theatre_analysis AUTO REFRESH YES ;`

相同的截图:

![output 10](../Images/f8651f9f8efb36cbf882144cea46fcfd.png)

<noscript><img class="alignnone wp-image-447717 size-full" src="../Images/f8651f9f8efb36cbf882144cea46fcfd.png" alt="output 10" width="540" height="314" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-10.png 540w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-10-300x174.png 300w" sizes="(max-width: 540px) 100vw, 540px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-10.png"/></noscript>

**刷新物化视图:**

`REFRESH materialized view MV_theatre_analysis ;`

相同的截图:

![output 11](../Images/f39c45c87fec1b9779662967962b0c69.png)

<noscript><img class="alignnone wp-image-447718 size-full" src="../Images/f39c45c87fec1b9779662967962b0c69.png" alt="output 11" width="425" height="297" srcset="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-11.png 425w, https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-11-300x210.png 300w" sizes="(max-width: 425px) 100vw, 425px" data-original-src="https://cdn.educba.com/academy/wp-content/uploads/2021/01/Redshift-materialized-views-output-11.png"/></noscript>

### 推荐文章

这是一个红移物化视图的指南。这里我们讨论物化视图如何在红移中工作，以及物化视图的图形表示。您也可以看看以下文章，了解更多信息–

1.  [什么是 AWS 红移？](https://www.educba.com/what-is-aws-redshift/)
2.  [云计算平台](https://www.educba.com/cloud-computing-platforms/)
3.  [AWS 极光](https://www.educba.com/aws-aurora/)
4.  [AWS 的优势](https://www.educba.com/benefits-of-aws/)

<footer class="entry-footer">

<aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar">Primary Sidebar</aside>

</footer>