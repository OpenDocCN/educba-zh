# MySQL 优化表

> 原文：<https://www.educba.com/mysql-optimize-table/>

![MySQL Optimize Table](img/fe05328b3b4d881b2fd71363154113a3.png)



## MySQL 优化表简介

Mysql 中有一个名为 query optimizer 的组件，它可以优化复杂的查询，并决定查询语句中涉及的表的执行流和索引，以尽可能地优化时间和性能。但是有时，特别是在一个表上定义了许多索引或者对表进行了大量更新和插入的情况下，查询优化器将无法优化查询，并且会导致查询执行的时间和空间复杂性。此外，当对表执行太多数据操作时，会导致存储在物理层的数据碎片化，因此获取索引数据会变得更慢。为此，MySQL 提供了一个名为 OPTIMIZE TABLE 的查询语句。

在本文中，我们将学习运行 optimize table 语句的用法和好处、语法和示例。

<small>Hadoop、数据科学、统计学&其他</small>

### 表的优化

数据在物理级别上如何存储在表中对索引和从中获取数据有很大影响。当对表执行严格的更新、删除或插入操作时，会在物理级别对数据进行碎片整理。这会影响应用程序和报告的性能，因为我们在内部使用由多个表上的多个连接组成的 SELECT 语句，这些表的索引和执行流由 MySQL 的查询优化器决定。这个优化器不能很好地处理碎片数据。优化表查询通过重新组织表数据的索引和物理存储，在物理级别对数据进行碎片整理，以提高输入/输出操作的效率，并减少存储数据所需的空间。

#### 1.InnoDB 存储引擎

对表执行的实际操作取决于表的存储引擎。在 InnoDB 表的情况下，当执行大量的更新、插入或删除操作，并且该表具有。启用 innodb_file_per_table 选项时，ibd 文件本身。在回收磁盘空间并对表上的索引进行重组之后，操作系统会使用磁盘空间。当对构成 InnoDB 表的全文搜索索引一部分的表列进行大量操作时，我们应该使用 OPTIMIZE TABLE 语句优化表。这提高了对表进行全文搜索的速度。

#### 2.MyISAM 或归档存储引擎

对于 MyISAM 或归档表，当执行了太多的删除操作，或者更改了数据类型为 VARCHAR、BLOB、TEXT 或 VARBINARY 的可变长度行时，您应该优化这些表，因为它会对数据进行碎片整理，并且用于存储记录的链表也会重新构造，从而可以利用未使用的空间。优化进一步提高了对表执行的查询语句的性能。

为了执行 OPTIMIZE TABLE 查询语句，我们需要对表具有 SELECT 和 INSERT 权限。注意，这个语句不能用于视图，因为视图不消耗物理内存，它们只是逻辑实体。我们也可以在分区表上运行这个语句。默认情况下，优化表语句被写入二进制日志。这确保了它们被进一步复制到表被复制的从属服务器。要跳过语句的日志记录，我们可以使用 NO_WRITE_TO_BINLOG 关键字或 LOCAL 关键字，方法是在优化表查询中指定它们。

**语法**

`OPTIMIZE [NO_WRITE_TO_BINLOG | LOCAL] TABLE name_of_table1 [, name_of_table2] ...`

NO_WRITE_TO_BINLOG 和 LOCAL 关键字是可选的，用于避免日志记录。我们可以同时优化单个或多个表，方法是以逗号分隔的方式提及它们，如语法所示。

优化表查询的输出提供了以下信息

**表格–**被优化的表格的名称。

**Op–**这始终是优化值。

**Msg _ type–**该字段可以包括以下值之一:状态、错误、信息、注释或警告，用于说明查询的执行状态。

**Msg _ text–**这是对已执行语句的额外描述。

### 例子

例如，我们将尝试优化 MySQL 数据库服务器上名为 educba 的数据库中名为 developers 的 InnoDB 表。为此，我们将使用以下查询语句

`OPTIMIZE TABLE developers;`

上述查询语句的执行会在执行后给出以下输出–

![mysql optimize table output](img/e7ecc7e8a7d2d9fb916ea03cc752a171.png)



在这种情况下，名为 developers 的表将被重新构建，索引统计信息将根据该表进行更新。此外，聚集索引中未使用的空间也会被清除。上面的输出表明该表已被重新创建，并且通过在内部执行 ANALYZE TABLE 命令完成了分析，该命令给出了查询的输出状态 OK。ANALYZE TABLE 语句为 MySQL 查询优化器有效执行做必要的分析，并相应地返回状态和相关信息。

如果对数据库执行了太多操作，导致对现有数据的操作，那么检查、分析和优化数据库的表是非常必要的。这有助于数据库管理员维护数据库，并保持基于数据库的应用程序的性能水平。

### 结论–MySQL 优化表

我们可以利用 MySQL 中提供的 OPTIMIZE TABLE 命令对用于存储表内容的数据进行碎片整理，这些数据是由于对表进行大量的插入、更新和删除操作而碎片化的。通过以逗号分隔的方式列出要优化的表的名称，我们可以使用同一个查询同时优化多个表。该优化导致表和其上定义的索引的重建，这释放了未使用的内存，这些内存可以进一步用于一些其他目的，并且当涉及许多查询的复杂查询用于检索数据时，还导致从表中更快地检索数据。

### 推荐文章

这是一个 MySQL 优化表的指南。这里我们用适当的语法和例子来讨论 MySQL 优化表的介绍。您也可以看看以下文章，了解更多信息–

1.  [MySQL 集群](https://www.educba.com/mysql-cluster/)
2.  [MySQL 用户](https://www.educba.com/mysql-users/)
3.  [MySQL 重新索引](https://www.educba.com/mysql-reindex/)
4.  [MySQL 替换](https://www.educba.com/mysql-replace/)





